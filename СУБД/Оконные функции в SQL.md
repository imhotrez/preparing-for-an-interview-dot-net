### **üìå –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏?**

**–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Window Functions)** –≤ SQL –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å **–∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è** (—Ç–∞–∫–∏–µ –∫–∞–∫ `SUM()`, `AVG()`, `ROW_NUMBER()` –∏ –¥—Ä.) **–ø–æ –≥—Ä—É–ø–ø–∞–º —Å—Ç—Ä–æ–∫**, –Ω–æ **–±–µ–∑ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã**, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `GROUP BY`.

üìå –ì–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `GROUP BY`:

- `GROUP BY` **—Å—Ö–ª–æ–ø—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏** –≤ –æ–¥–Ω—É (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è).
- –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ **–æ—Å—Ç–∞–≤–ª—è—é—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏**, –¥–æ–±–∞–≤–ª—è—è **–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**.

---

## **üîπ –û–±—â–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**

```sql
<window_function>() OVER (
    PARTITION BY column_name   -- –†–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≥—Ä—É–ø–ø—ã (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å GROUP BY)
    ORDER BY column_name       -- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫
    ROWS BETWEEN ...           -- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç "–æ–∫–Ω–æ" —Å—Ç—Ä–æ–∫ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
)
```

- **`PARTITION BY`** (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) ‚Äî –¥–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≥—Ä—É–ø–ø—ã (–ø–æ–¥–æ–±–Ω–æ `GROUP BY`).
- **`ORDER BY`** (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) ‚Äî –∑–∞–¥–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫.
- **`ROWS BETWEEN ...`** (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä "–æ–∫–Ω–∞" –¥–∞–Ω–Ω—ã—Ö.

---

## **üîπ –í–∏–¥—ã –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π**

–û–Ω–∏ –¥–µ–ª—è—Ç—Å—è –Ω–∞ **—Ç—Ä–∏ —Ç–∏–ø–∞**:

1. **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (Ranking Functions)** ‚Üí `ROW_NUMBER()`, `RANK()`, `DENSE_RANK()`, `NTILE()`
2. **–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Aggregate Window Functions)** ‚Üí `SUM()`, `AVG()`, `MIN()`, `MAX()`, `COUNT()`
3. **–§—É–Ω–∫—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏—è (Offset Functions)** ‚Üí `LAG()`, `LEAD()`, `FIRST_VALUE()`, `LAST_VALUE()`

---

## **1Ô∏è‚É£ –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è**

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è **–ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫** –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞.

### **üìå `ROW_NUMBER()`**

–í—ã–¥–∞–µ—Ç **—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä** –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –≥—Ä—É–ø–ø–µ, –Ω–∞—á–∏–Ω–∞—è —Å `1`.

```sql
SELECT employee_id, department, salary,
       ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) AS row_num
FROM employees;
```

üîπ **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å **—Ç–æ–ø-N –∑–∞–ø–∏—Å–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, **—Å–∞–º—ã–µ –≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ**).

---

### **üìå `RANK()`**

–ü–æ—Ö–æ–∂ –Ω–∞ `ROW_NUMBER()`, –Ω–æ –µ—Å–ª–∏ –µ—Å—Ç—å **–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**, –æ–Ω **–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –Ω–æ–º–µ—Ä–∞**.

```sql
SELECT employee_id, department, salary,
       RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS ranking
FROM employees;
```

üìå –ï—Å–ª–∏ –¥–≤–∞ —á–µ–ª–æ–≤–µ–∫–∞ –ø–æ–ª—É—á–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –∑–∞—Ä–ø–ª–∞—Ç—É, –æ–Ω–∏ **–ø–æ–ª—É—á–∞—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ä–∞–Ω–≥**, –∞ —Å–ª–µ–¥—É—é—â–∏–π **–±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω**.  
–ü—Ä–∏–º–µ—Ä: `1, 2, 2, 4` (–ø—Ä–æ–ø—É—â–µ–Ω `3`).

---

### **üìå `DENSE_RANK()`**

–ö–∞–∫ `RANK()`, –Ω–æ **–Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –Ω–æ–º–µ—Ä–∞**.

```sql
SELECT employee_id, department, salary,
       DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS dense_ranking
FROM employees;
```

üìå –ï—Å–ª–∏ –∑–∞—Ä–ø–ª–∞—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, —Ä–∞–Ω–≥–∏ —Ç–æ–∂–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –Ω–æ **—Å–ª–µ–¥—É—é—â–∏–π –Ω–æ–º–µ—Ä –Ω–µ –ø—Ä–æ–ø—É—â–µ–Ω**:  
–ü—Ä–∏–º–µ—Ä: `1, 2, 2, 3`.

---

### **üìå `NTILE(N)`**

–î–µ–ª–∏—Ç —Å—Ç—Ä–æ–∫–∏ –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ –Ω–∞ `N` —Ä–∞–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π (–ø—Ä–∏–º–µ—Ä–Ω–æ).

```sql
SELECT employee_id, department, salary,
       NTILE(4) OVER (PARTITION BY department ORDER BY salary DESC) AS quartile
FROM employees;
```

üìå –†–∞–∑–¥–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ 4 **—Ä–∞–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã** (–∫–≤–∞—Ä—Ç–µ–ª–∏).

---

## **2Ô∏è‚É£ –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ–∫–Ω–∞—Ö**

–†–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ `SUM()`, `AVG()`, `COUNT()`, –Ω–æ **–Ω–µ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç —Å—Ç—Ä–æ–∫–∏**.

### **üìå `SUM() OVER()`**

–ù–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —Å—É–º–º—É –æ—Ç **–Ω–∞—á–∞–ª–∞ –æ–∫–Ω–∞**.

```sql
SELECT employee_id, department, salary,
       SUM(salary) OVER (PARTITION BY department ORDER BY employee_id) AS running_total
FROM employees;
```

üìå –ü–æ–∑–≤–æ–ª—è–µ—Ç **—Å—á–∏—Ç–∞—Ç—å –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏–π –∏—Ç–æ–≥ (cumulative sum)**.

---

### **üìå `AVG() OVER()`**

–°—á–∏—Ç–∞–µ—Ç **—Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ**.

```sql
SELECT employee_id, department, salary,
       AVG(salary) OVER (PARTITION BY department ORDER BY employee_id ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg
FROM employees;
```

üìå **–ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞.

---

## **3Ô∏è‚É£ –§—É–Ω–∫—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏—è**

–ü–æ–∑–≤–æ–ª—è—é—Ç **–æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∏ —Å–ª–µ–¥—É—é—â–∏–º —Å—Ç—Ä–æ–∫–∞–º**.

### **üìå `LAG()`**

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ **–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏**.

```sql
SELECT employee_id, department, salary,
       LAG(salary, 1, 0) OVER (PARTITION BY department ORDER BY employee_id) AS prev_salary
FROM employees;
```

üìå **–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞—Ä–ø–ª–∞—Ç–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º).

---

### **üìå `LEAD()`**

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ **–∏–∑ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏**.

```sql
SELECT employee_id, department, salary,
       LEAD(salary, 1, 0) OVER (PARTITION BY department ORDER BY employee_id) AS next_salary
FROM employees;
```

üìå **–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞—Ä–ø–ª–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞).

---

### **üìå `FIRST_VALUE()`**

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ø–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –æ–∫–Ω–µ**.

```sql
SELECT employee_id, department, salary,
       FIRST_VALUE(salary) OVER (PARTITION BY department ORDER BY salary DESC) AS highest_salary
FROM employees;
```

üìå **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ**.

---

### **üìå `LAST_VALUE()`**

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –æ–∫–Ω–µ**.

```sql
SELECT employee_id, department, salary,
       LAST_VALUE(salary) OVER (PARTITION BY department ORDER BY salary DESC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS lowest_salary
FROM employees;
```

üìå **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –æ–∫–Ω–µ**.

---

## **üîπ –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ vs. `GROUP BY`**

||–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏|`GROUP BY`|
|---|---|---|
|**–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏?**|‚úÖ –î–∞|‚ùå –ù–µ—Ç|
|**–†–∞–±–æ—Ç–∞–µ—Ç —Å `ORDER BY`?**|‚úÖ –î–∞|‚ö†Ô∏è –ù–µ –≤—Å–µ–≥–¥–∞|
|**–ú–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—É–º–º—ã?**|‚úÖ –î–∞|‚ùå –ù–µ—Ç|
|**–ú–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏/—Å–ª–µ–¥—É—é—â–∏–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏?**|‚úÖ –î–∞ (`LAG()`, `LEAD()`)|‚ùå –ù–µ—Ç|

---

## **üîπ –ì–¥–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏?**

‚úîÔ∏è **–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** ‚Üí –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã, —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.  
‚úîÔ∏è **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ä–µ–π—Ç–∏–Ω–≥–∏, –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã)** ‚Üí `ROW_NUMBER()`, `RANK()`.  
‚úîÔ∏è **–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** ‚Üí `LAG()`, `LEAD()`.  
‚úîÔ∏è **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã** ‚Üí —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ.  
‚úîÔ∏è **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤** ‚Üí –∑–∞–º–µ–Ω—è–µ—Ç `GROUP BY` –≤ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

---

## **üîπ –ò—Ç–æ–≥**

üìå **–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç SQL, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è **–±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å—Ç—Ä–æ–∫**.  
üìå –û–Ω–∏ **–≥–∏–±—á–µ `GROUP BY`** –∏ –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è **–∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤, —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π**.  
üìå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **`PARTITION BY` + `ORDER BY`** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–±–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ **–≥—Ä—É–ø–ø—ã** –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.

–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–µ–Ω —Ä–∞–∑–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–µ–π—Å–∞ ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞–π! üöÄ
