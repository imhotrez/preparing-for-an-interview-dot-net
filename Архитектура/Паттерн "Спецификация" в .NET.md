# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ë–î

#### **1. –ü—Ä–æ–±–ª–µ–º–∞**

–í **—á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ** —è–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (`Domain` –∏–ª–∏ `Core`) **–Ω–µ –¥–æ–ª–∂–Ω–æ –∑–Ω–∞—Ç—å –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**.  
–ù–æ –µ—Å–ª–∏ –º—ã –ø–∏—à–µ–º **–≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã**, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ –ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º Email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"), —Ç–æ **–∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å, –Ω–µ –Ω–∞—Ä—É—à–∞—è –ø—Ä–∏–Ω—Ü–∏–ø—ã —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã?**

üëâ **–†–µ—à–µ–Ω–∏–µ** ‚Äî –ø–∞—Ç—Ç–µ—Ä–Ω **"–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è"** –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–∏—Å–∞—Ç—å —Ç–∞–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ **—è–¥—Ä–µ**, –Ω–æ –±–µ–∑ —è–≤–Ω–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ë–î.

---

## **2. –†–µ—à–µ–Ω–∏–µ: "–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è" –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π**

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –æ–±—ä–µ–∫—Ç–∞ –ø—Ä—è–º–æ –≤ –ë–î –≤–Ω—É—Ç—Ä–∏ —è–¥—Ä–∞ (`Domain`), –º—ã —Å–æ–∑–¥–∞—ë–º **–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å** `Specification<T>`, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç **–ø—Ä–∞–≤–∏–ª–æ**, –∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π —É–∂–µ —Å–∞–º —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ –µ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å (–≤ –ë–î –∏–ª–∏ –≤ –ø–∞–º—è—Ç–∏).

---

### **3. –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å "–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è"**

–ú—ã —Å–æ–∑–¥–∞—ë–º **—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é** —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç:  
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å —É—Å–ª–æ–≤–∏–µ –≤ –ø–∞–º—è—Ç–∏ (`IsSatisfiedBy`)  
‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å LINQ-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ (`ToExpression`) –¥–ª—è –±–∞–∑—ã

```csharp
using System;
using System.Linq.Expressions;

public abstract class Specification<T>
{
    public abstract Expression<Func<T, bool>> ToExpression();

    public bool IsSatisfiedBy(T entity)
    {
        var predicate = ToExpression().Compile();
        return predicate(entity);
    }
}
```

---

### **4. –ü—Ä–∏–º–µ—Ä: –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ Email**

–í `Domain` —Å–æ–∑–¥–∞—ë–º **—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é**, –∫–æ—Ç–æ—Ä–∞—è **–æ–ø–∏—Å–∞–Ω–∞ —á–µ—Ä–µ–∑ LINQ** (–Ω–æ –ë–î –æ –Ω–µ–π –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç).

```csharp
public class UniqueEmailSpecification : Specification<User>
{
    private readonly string _email;

    public UniqueEmailSpecification(string email)
    {
        _email = email;
    }

    public override Expression<Func<User, bool>> ToExpression()
    {
        return user => user.Email == _email;
    }
}
```

---

### **5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —è–¥—Ä–∞**

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë **–≤ –ª—é–±–æ–º –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–µ —è–¥—Ä–∞**, –Ω–µ –∑–Ω–∞—è –æ –ë–î:

```csharp
public class RegisterUserValidator
{
    private readonly IRepository<User> _userRepository;

    public RegisterUserValidator(IRepository<User> userRepository)
    {
        _userRepository = userRepository;
    }

    public async Task ValidateAsync(string email)
    {
        var emailSpec = new UniqueEmailSpecification(email);

        bool exists = await _userRepository.AnyAsync(emailSpec);
        if (exists)
        {
            throw new Exception("User with this email already exists.");
        }
    }
}
```

---

### **6. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ (–ë–î)**

–¢–µ–ø–µ—Ä—å –≤ **–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ** –º—ã –º–æ–∂–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é **–ø—Ä—è–º–æ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** —Å –ø–æ–º–æ—â—å—é LINQ:

```csharp
public class UserRepository : IRepository<User>
{
    private readonly DbContext _context;

    public UserRepository(DbContext context)
    {
        _context = context;
    }

    public async Task<bool> AnyAsync(Specification<User> spec)
    {
        return await _context.Set<User>().AnyAsync(spec.ToExpression());
    }
}
```

---

## **7. –ò—Ç–æ–≥: —á—Ç–æ –º—ã –ø–æ–ª—É—á–∏–ª–∏?**

‚úÖ **–ß–∏—Å—Ç–æ–µ —è–¥—Ä–æ** ‚Äî –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –≤ `Domain` –≤–æ–æ–±—â–µ –Ω–µ –∑–Ω–∞—é—Ç –æ –ë–î  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** ‚Äî –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –≤ –ø–∞–º—è—Ç–∏, –∏ –≤ –ë–î  
‚úÖ **–õ–µ–≥–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –º–æ–∂–Ω–æ –º–æ–∫–∞—Ç—å `IRepository` –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ë–î

–ö–∞–∫ —Ç–µ–±–µ —Ç–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ? üöÄ
